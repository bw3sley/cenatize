!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jsdom")):"function"==typeof define&&define.amd?define(["exports","jsdom"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).cenatizer={},e.JSDOM)}(this,(function(e,t){"use strict";const i=["a","abbr","b","blockquote","body","br","center","code","dd","div","dl","dt","em","font","h1","h2","h3","h4","h5","h6","hr","i","img","label","li","ol","p","pre","small","source","span","strong","sub","sup","table","tbody","tr","td","th","thead","ul","u","video","svg","circle","ellipse","line","path","polygon","polyline","rect","text","g"],o={"*":["align","color","controls","height","href","id","src","style","target","title","type","width"],a:["href","target"],img:["src","alt","title","width","height"],video:["src","controls","width","height"],svg:["width","height","viewBox"],circle:["cx","cy","r","fill"],rect:["x","y","width","height","fill"],line:["x1","y1","x2","y2","stroke"],path:["d","fill"],polygon:["points","fill"],polyline:["points","fill"],text:["x","y","fill"],g:[]},n=["http:","https:","data:","m-files:","file:","ftp:","mailto:","pw:"],l=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr"];function r(e,t){const{Node:c}=t.window;if(e.nodeType===c.TEXT_NODE)return e.nodeValue;if(e.nodeType===c.ELEMENT_NODE){const c=e.tagName.toLowerCase();if("script"===c)return"";if(!i.includes(c)){let i="";for(const o of e.childNodes)i+=r(o,t);return i}let s=`<${c}`;for(const{name:t,value:i}of e.attributes){const e=t.toLowerCase(),l=o["*"].includes(e),r=(o[c]||[]).includes(e);if(!l&&!r)continue;if(["href","src","action"].includes(e))try{const e=new URL(i,"http://example.com");if(!n.includes(e.protocol))continue}catch{continue}s+=` ${t}="${i.replace(/"/g,"&quot;")}"`}if(s+=">",l.includes(c))return s;for(const i of e.childNodes)s+=r(i,t);return s+=`</${c}>`,s}return""}const c={html:function(e){const i=new t.JSDOM(`<div id="__sanitize_root__">${e}</div>`),o=i.window.document.getElementById("__sanitize_root__");let n="";for(const e of o.childNodes)n+=r(e,i);return n},js:function(e){return e.replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"")}};e.cenatizer=c}));
